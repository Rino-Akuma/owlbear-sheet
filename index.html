<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
body{
  background:#1e1f22;
  color:white;
  font-family:Arial;
  position:relative;
  padding-top:40px;
}

/* === –ë–õ–û–ö –Ü–ú–ü–û–†–¢/–ï–ö–°–ü–û–†–¢ (–ü–†–ê–í–ò–ô –í–ï–†–•) === */
.top-right-tools{
  position:absolute;
  top:10px;
  right:10px;
  display:flex;
  gap:6px;
}

.top-right-tools button{
  background:#2b2d31;
  color:white;
  border:1px solid #555;
  padding:5px 8px;
  border-radius:6px;
  cursor:pointer;
}

/* === –ü–ï–†–ï–ú–Ü–ö–ê–ß –ú–û–í (–¶–ï–ù–¢–†) === */
.lang-switch{
  position:absolute;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:6px;
}
.lang-switch button{
  background:#2b2d31;
  color:white;
  border:1px solid #555;
  padding:5px 8px;
  border-radius:6px;
  cursor:pointer;
}

/* –ö–Ω–æ–ø–∫–∏ –≤–∫–ª–∞–¥–æ–∫ */
.tabs{
  display:flex;
  gap:6px;
  margin-bottom:8px;
}

.tabs button{
  background:#2b2d31;
  color:white;
  border:1px solid #555;
  padding:6px 10px;
  border-radius:6px;
  cursor:pointer;
}

.tabs button.active{
  background:#3b3f45;
  border-color:#7dd3fc;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –≤–∫–ª–∞–¥–æ–∫ */
.tab-content{
  display:none;
  border:1px solid #666;
  border-radius:8px;
  padding:6px;
  background:#24262a;
  min-height:500px;
}
</style>
</head>
<body>

<h3 data-i18n="sheet_title">–õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h3>

<!-- ===== –Ü–ú–ü–û–†–¢ / –ï–ö–°–ü–û–†–¢ (–ø—Ä–∞–≤–æ—Ä—É—á) ===== -->
<div class="top-right-tools">
  <button id="exportBtn" data-i18n="export_btn">üì§ –ï–∫—Å–ø–æ—Ä—Ç</button>
  <button id="importBtn" data-i18n="import_btn">üì• –Ü–º–ø–æ—Ä—Ç</button>
  <input type="file" id="importFile" accept=".json" style="display:none;">
</div>

<!-- ===== –ü–ï–†–ï–ú–Ü–ö–ê–ß –ú–û–í (—Ü–µ–Ω—Ç—Ä) ===== -->
<div class="lang-switch">
  <button onclick="setLang('ru')">RU</button>
  <button onclick="setLang('ua')">UA</button>
</div>

<div class="tabs">
  <button data-tab="stats" class="active" data-i18n="tab_stats">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  <button data-tab="weapons" data-i18n="tab_weapons">–û—Ä—É–∂–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  <button data-tab="magic" data-i18n="tab_magic">–ú–∞–≥–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  <button data-tab="equipment" data-i18n="tab_equipment">–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  <button data-tab="description" data-i18n="tab_description">–û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  <button data-tab="notes" data-i18n="tab_notes">–ó–∞–º–µ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
</div>

<div id="tab_stats" class="tab-content"></div>
<div id="tab_weapons" class="tab-content"></div>
<div id="tab_magic" class="tab-content"></div>
<div id="tab_equipment" class="tab-content"></div>
<div id="tab_description" class="tab-content"></div>
<div id="tab_notes" class="tab-content"></div>

<script>
/* ================== –ü–ï–†–ï–ö–õ–ê–î ================== */
const translations = {
  ru:{
    sheet_title: "–õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    export_btn: "üì§ –≠–∫—Å–ø–æ—Ä—Ç",
    import_btn: "üì• –ò–º–ø–æ—Ä—Ç",
    tab_stats: "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    tab_weapons: "–û—Ä—É–∂–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    tab_magic: "–ú–∞–≥–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    tab_equipment: "–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    tab_description: "–û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    tab_notes: "–ó–∞–º–µ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"
  },
  ua:{
    sheet_title: "–õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    export_btn: "üì§ –ï–∫—Å–ø–æ—Ä—Ç",
    import_btn: "üì• –Ü–º–ø–æ—Ä—Ç",
    tab_stats: "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    tab_weapons: "–ó–±—Ä–æ—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    tab_magic: "–ú–∞–≥—ñ—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    tab_equipment: "–°–Ω–∞—Ä—è–¥–∂–µ–Ω–Ω—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    tab_description: "–û–ø–∏—Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    tab_notes: "–ù–æ—Ç–∞—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞"
  }
};

function setLang(lang){
  localStorage.setItem("owlbear_lang", lang);

  document.querySelectorAll("[data-i18n]").forEach(el=>{
    const key = el.dataset.i18n;
    if(translations[lang][key]) el.textContent = translations[lang][key];
  });
}

/* –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –º–æ–≤—É –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ */
setLang(localStorage.getItem("owlbear_lang") || "ru");

/* ================== –í–ö–õ–ê–î–ö–ò ================== */
const buttons = document.querySelectorAll(".tabs button");
const containers = document.querySelectorAll(".tab-content");

// –©–æ–± —Å–∫—Ä–∏–ø—Ç–∏ –Ω–µ –¥—É–±–ª—é–≤–∞–ª–∏—Å—å
const loadedScripts = new Set();

buttons.forEach(btn=>{
  btn.addEventListener("click", async ()=>{
    buttons.forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");

    containers.forEach(c=>c.style.display="none");

    const tab = btn.dataset.tab;
    const container = document.getElementById("tab_"+tab);
    container.style.display="block";

    if(!container.dataset.loaded){
      const html = await fetch(tab + ".html").then(r=>r.text());
      container.innerHTML = html;
      container.dataset.loaded = "true";

      // –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ JS –¢–Ü–õ–¨–ö–ò –û–î–ò–ù –†–ê–ó
      if(!loadedScripts.has(tab)){
        const script = document.createElement("script");
        script.src = tab + ".js";
        document.body.appendChild(script);
        loadedScripts.add(tab);
      }
    }
  });
});

// –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –ø–µ—Ä—à—É –≤–∫–ª–∞–¥–∫—É
document.querySelector('[data-tab="stats"]').click();

/* ================== –Ü–ú–ü–û–†–¢ / –ï–ö–°–ü–û–†–¢ ================== */
// –ï–ö–°–ü–û–†–¢ –£–°–¨–û–ì–û localStorage
document.getElementById("exportBtn").addEventListener("click", ()=>{
  const data = {};
  for(let i=0;i<localStorage.length;i++){
    const key = localStorage.key(i);
    data[key] = localStorage.getItem(key);
  }
  const blob = new Blob([JSON.stringify(data,null,2)], {type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "owlbear_sheet_backup.json";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
});

// –Ü–ú–ü–û–†–¢
document.getElementById("importBtn").addEventListener("click", ()=>{
  document.getElementById("importFile").click();
});
document.getElementById("importFile").addEventListener("change", (e)=>{
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(event){
    try{
      const data = JSON.parse(event.target.result);
      localStorage.clear();
      Object.keys(data).forEach(key=>{
        localStorage.setItem(key,data[key]);
      });
      alert("–Ü–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂ —Å—Ç–æ—Ä—ñ–Ω–∫—É.");
    }catch(err){
      alert("–ü–æ–º–∏–ª–∫–∞ —Ñ–∞–π–ª—É! –ü–æ—Ç—Ä—ñ–±–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π JSON.");
    }
  };
  reader.readAsText(file);
});
</script>

</body>
</html>
