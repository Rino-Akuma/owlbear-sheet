<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
body{
  background:#1e1f22;
  color:white;
  font-family:Arial;
}

/* ======= –ü–ï–†–ï–ú–ò–ö–ê–ß –ú–û–í (–ó–í–ï–†–•–£ –ü–û –¶–ï–ù–¢–†–£) ======= */
.lang-switcher{
  position:absolute;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:6px;
}

.lang-switcher button{
  background:#2b2d31;
  color:white;
  border:1px solid #555;
  padding:5px 10px;
  border-radius:6px;
  cursor:pointer;
}

.lang-switcher button.active{
  background:#3b3f45;
  border-color:#7dd3fc;
}

/* === –ë–õ–û–ö –Ü–ú–ü–û–†–¢/–ï–ö–°–ü–û–†–¢ (–°–ü–†–ê–í–ê –í–ì–û–†–Ü) === */
.top-right-tools{
  position:absolute;
  top:10px;
  right:10px;
  display:flex;
  gap:6px;
}

.top-right-tools button{
  background:#2b2d31;
  color:white;
  border:1px solid #555;
  padding:5px 8px;
  border-radius:6px;
  cursor:pointer;
}

/* –ö–Ω–æ–ø–∫–∏ –≤–∫–ª–∞–¥–æ–∫ */
.tabs{
  display:flex;
  gap:6px;
  margin-top:40px;
  margin-bottom:8px;
}

.tabs button{
  background:#2b2d31;
  color:white;
  border:1px solid #555;
  padding:6px 10px;
  border-radius:6px;
  cursor:pointer;
}

.tabs button.active{
  background:#3b3f45;
  border-color:#7dd3fc;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –≤–∫–ª–∞–¥–æ–∫ */
.tab-content{
  display:none;
  border:1px solid #666;
  border-radius:8px;
  padding:6px;
  background:#24262a;
  min-height:500px;
}
</style>
</head>
<body>

<h3 id="title">–õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</h3>

<!-- ===== –ü–ï–†–ï–ú–ò–ö–ê–ß –ú–û–í ===== -->
<div class="lang-switcher">
  <button id="btn_ru">RU</button>
  <button id="btn_ua">UA</button>
</div>

<!-- ===== –Ü–ú–ü–û–†–¢ / –ï–ö–°–ü–û–†–¢ ===== -->
<div class="top-right-tools">
  <button id="exportBtn">üì§ –ï–∫—Å–ø–æ—Ä—Ç</button>
  <button id="importBtn">üì• –Ü–º–ø–æ—Ä—Ç</button>
  <input type="file" id="importFile" accept=".json" style="display:none;">
</div>

<div class="tabs">
  <button data-tab="stats" class="active" data-i18n="stats">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  <button data-tab="weapons" data-i18n="weapons">–û—Ä—É–∂–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  <button data-tab="magic" data-i18n="magic">–ú–∞–≥–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  <button data-tab="equipment" data-i18n="equipment">–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  <button data-tab="description" data-i18n="description">–û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
  <button data-tab="notes" data-i18n="notes">–ó–∞–º–µ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</button>
</div>

<div id="tab_stats" class="tab-content"></div>
<div id="tab_weapons" class="tab-content"></div>
<div id="tab_magic" class="tab-content"></div>
<div id="tab_equipment" class="tab-content"></div>
<div id="tab_description" class="tab-content"></div>
<div id="tab_notes" class="tab-content"></div>

<script>
const buttons = document.querySelectorAll(".tabs button");
const containers = document.querySelectorAll(".tab-content");

// –©–æ–± —Å–∫—Ä–∏–ø—Ç–∏ –Ω–µ –¥—É–±–ª—é–≤–∞–ª–∏—Å—å
const loadedScripts = new Set();

/* ================== –ü–ï–†–ï–ö–õ–ê–î–ò –î–õ–Ø INDEX ================== */
const translations = {
  ru: {
    title: "–õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    stats: "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    weapons: "–û—Ä—É–∂–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    magic: "–ú–∞–≥–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    equipment: "–°–Ω–∞—Ä—è–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    description: "–û–ø–∏—Å–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    notes: "–ó–∞–º–µ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    export: "üì§ –≠–∫—Å–ø–æ—Ä—Ç",
    import: "üì• –ò–º–ø–æ—Ä—Ç"
  },
  ua: {
    title: "–õ–∏—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    stats: "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    weapons: "–ó–±—Ä–æ—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    magic: "–ú–∞–≥—ñ—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    equipment: "–°–ø–æ—Ä—è–¥–∂–µ–Ω–Ω—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    description: "–û–ø–∏—Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    notes: "–ù–æ—Ç–∞—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞",
    export: "üì§ –ï–∫—Å–ø–æ—Ä—Ç",
    import: "üì• –Ü–º–ø–æ—Ä—Ç"
  }
};

/* ============ –§–£–ù–ö–¶–Ü–Ø –ó–ú–Ü–ù–ò –ú–û–í–ò ============ */
function setLang(lang){
  localStorage.setItem("owlbear_lang", lang);

  // –ó–º—ñ–Ω—é—î–º–æ —Ç–µ–∫—Å—Ç –≤ INDEX
  document.getElementById("title").textContent = translations[lang].title;

  document.querySelectorAll(".tabs button").forEach(btn=>{
    const key = btn.dataset.i18n;
    btn.textContent = translations[lang][key];
  });

  document.getElementById("exportBtn").textContent = translations[lang].export;
  document.getElementById("importBtn").textContent = translations[lang].import;

  // –ü—ñ–¥—Å–≤—ñ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫
  document.getElementById("btn_ru").classList.toggle("active", lang==="ru");
  document.getElementById("btn_ua").classList.toggle("active", lang==="ua");

  // ===== –ù–ê–ô–í–ê–ñ–õ–ò–í–Ü–®–ï: –°–ü–û–í–Ü–©–ê–Ñ–ú–û –í–°–Ü –í–ö–õ–ê–î–ö–ò =====
  window.dispatchEvent(new Event("changeLang"));
}

/* ===== –ü–æ–¥—ñ—ó –Ω–∞ –∫–Ω–æ–ø–∫–∏ –º–æ–≤ ===== */
document.getElementById("btn_ru").addEventListener("click", ()=>setLang("ru"));
document.getElementById("btn_ua").addEventListener("click", ()=>setLang("ua"));

/* ===== –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–æ–≤—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ ===== */
const savedLang = localStorage.getItem("owlbear_lang") || "ru";
setLang(savedLang);

/* ================== –õ–û–ì–Ü–ö–ê –í–ö–õ–ê–î–û–ö ================== */
buttons.forEach(btn=>{
  btn.addEventListener("click", async ()=>{
    buttons.forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");

    containers.forEach(c=>c.style.display="none");

    const tab = btn.dataset.tab;
    const container = document.getElementById("tab_"+tab);
    container.style.display="block";

    if(!container.dataset.loaded){
      const html = await fetch(tab + ".html").then(r=>r.text());
      container.innerHTML = html;
      container.dataset.loaded = "true";

      // üî• –í–ê–ñ–õ–ò–í–û: –∑–º—É—à—É—î–º–æ –Ω–æ–≤—É –≤–∫–ª–∞–¥–∫—É –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º–æ–≤—É
setTimeout(() => {
  window.dispatchEvent(new Event("changeLang"));
}, 0);


      if(!loadedScripts.has(tab)){
        const script = document.createElement("script");
        script.src = tab + ".js";
        document.body.appendChild(script);
        loadedScripts.add(tab);
      }
    }
  });
});

// –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –ø–µ—Ä—à—É –≤–∫–ª–∞–¥–∫—É
document.querySelector('[data-tab="stats"]').click();

/* ================== –Ü–ú–ü–û–†–¢ / –ï–ö–°–ü–û–†–¢ ================== */

// –ï–ö–°–ü–û–†–¢ –£–°–¨–û–ì–û localStorage
document.getElementById("exportBtn").addEventListener("click", ()=>{
  const data = {};

  for(let i=0; i<localStorage.length; i++){
    const key = localStorage.key(i);
    data[key] = localStorage.getItem(key);
  }

  const blob = new Blob([JSON.stringify(data, null, 2)], {type: "application/json"});
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = "owlbear_sheet_backup.json";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
});

// –Ü–ú–ü–û–†–¢
document.getElementById("importBtn").addEventListener("click", ()=>{
  document.getElementById("importFile").click();
});

document.getElementById("importFile").addEventListener("change", (e)=>{
  const file = e.target.files[0];
  if(!file) return;

  const reader = new FileReader();
  reader.onload = function(event){
    try{
      const data = JSON.parse(event.target.result);

      localStorage.clear();

      Object.keys(data).forEach(key=>{
        localStorage.setItem(key, data[key]);
      });

      alert("–Ü–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂ —Å—Ç–æ—Ä—ñ–Ω–∫—É.");
    }catch(err){
      alert("–ü–æ–º–∏–ª–∫–∞ —Ñ–∞–π–ª—É! –ü–æ—Ç—Ä—ñ–±–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π JSON.");
    }
  };

  reader.readAsText(file);
});
</script>

</body>
</html>
