<script>
const buttons = document.querySelectorAll(".tabs button");
const containers = document.querySelectorAll(".tab-content");

async function loadTab(tab, container) {
  if (container.dataset.loaded) return;

  // 1) Завантажуємо HTML
  const html = await fetch(tab + ".html").then(r => r.text());
  container.innerHTML = html;

  // 2) ЧЕКАЄМО, поки браузер реально вставить цей HTML у DOM
  await new Promise(resolve => setTimeout(resolve, 10));

  // 3) ТЕПЕР підключаємо JS вкладки
  const script = document.createElement("script");
  script.src = tab + ".js";
  document.body.appendChild(script);

  container.dataset.loaded = "true";
}

buttons.forEach(btn => {
  btn.addEventListener("click", async () => {

    // прибираємо активність
    buttons.forEach(b => b.classList.remove("active"));
    btn.classList.add("active");

    // ховаємо всі вкладки
    containers.forEach(c => c.style.display = "none");

    // показуємо потрібну
    const tab = btn.dataset.tab;
    const container = document.getElementById("tab_" + tab);
    container.style.display = "block";

    // завантажуємо її ТІЛЬКИ ПЕРШИЙ РАЗ
    await loadTab(tab, container);
  });
});

// автоматично відкриваємо першу вкладку
document.querySelector('[data-tab="stats"]').click();
</script>
